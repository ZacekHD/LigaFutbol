USE [PruebaDB]
GO
/****** Object:  Table [dbo].[__EFMigrationsHistory]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[__EFMigrationsHistory](
	[MigrationId] [nvarchar](150) NOT NULL,
	[ProductVersion] [nvarchar](32) NOT NULL,
 CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY CLUSTERED 
(
	[MigrationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetRoleClaims]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetRoleClaims](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[RoleId] [nvarchar](450) NOT NULL,
	[ClaimType] [nvarchar](max) NULL,
	[ClaimValue] [nvarchar](max) NULL,
 CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetRoles]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetRoles](
	[Id] [nvarchar](450) NOT NULL,
	[Name] [nvarchar](256) NULL,
	[NormalizedName] [nvarchar](256) NULL,
	[ConcurrencyStamp] [nvarchar](max) NULL,
 CONSTRAINT [PK_AspNetRoles] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetUserClaims]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetUserClaims](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[UserId] [nvarchar](450) NOT NULL,
	[ClaimType] [nvarchar](max) NULL,
	[ClaimValue] [nvarchar](max) NULL,
 CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetUserLogins]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetUserLogins](
	[LoginProvider] [nvarchar](128) NOT NULL,
	[ProviderKey] [nvarchar](128) NOT NULL,
	[ProviderDisplayName] [nvarchar](max) NULL,
	[UserId] [nvarchar](450) NOT NULL,
 CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY CLUSTERED 
(
	[LoginProvider] ASC,
	[ProviderKey] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetUserRoles]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetUserRoles](
	[UserId] [nvarchar](450) NOT NULL,
	[RoleId] [nvarchar](450) NOT NULL,
 CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[RoleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetUsers]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetUsers](
	[Id] [nvarchar](450) NOT NULL,
	[UserName] [nvarchar](256) NULL,
	[NormalizedUserName] [nvarchar](256) NULL,
	[Email] [nvarchar](256) NULL,
	[NormalizedEmail] [nvarchar](256) NULL,
	[EmailConfirmed] [bit] NOT NULL,
	[PasswordHash] [nvarchar](max) NULL,
	[SecurityStamp] [nvarchar](max) NULL,
	[ConcurrencyStamp] [nvarchar](max) NULL,
	[PhoneNumber] [nvarchar](max) NULL,
	[PhoneNumberConfirmed] [bit] NOT NULL,
	[TwoFactorEnabled] [bit] NOT NULL,
	[LockoutEnd] [datetimeoffset](7) NULL,
	[LockoutEnabled] [bit] NOT NULL,
	[AccessFailedCount] [int] NOT NULL,
 CONSTRAINT [PK_AspNetUsers] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AspNetUserTokens]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AspNetUserTokens](
	[UserId] [nvarchar](450) NOT NULL,
	[LoginProvider] [nvarchar](128) NOT NULL,
	[Name] [nvarchar](128) NOT NULL,
	[Value] [nvarchar](max) NULL,
 CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY CLUSTERED 
(
	[UserId] ASC,
	[LoginProvider] ASC,
	[Name] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Noticias]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Noticias](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Titulo] [varchar](450) NULL,
	[Fecha] [datetime] NULL,
	[Texto] [varchar](max) NULL,
	[FotoUrl] [varchar](max) NULL,
	[Autor] [varchar](100) NULL,
	[TextoCorto] [varchar](450) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Slider]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Slider](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[FotoUrl] [varchar](max) NULL,
	[Clase] [varchar](50) NULL,
	[Titulo] [varchar](max) NULL,
	[Descripcion] [varchar](max) NULL,
	[Id_Titular] [int] NULL,
	[Fecha] [datetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
ALTER TABLE [dbo].[AspNetRoleClaims]  WITH CHECK ADD  CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY([RoleId])
REFERENCES [dbo].[AspNetRoles] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetRoleClaims] CHECK CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId]
GO
ALTER TABLE [dbo].[AspNetUserClaims]  WITH CHECK ADD  CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[AspNetUsers] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetUserClaims] CHECK CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId]
GO
ALTER TABLE [dbo].[AspNetUserLogins]  WITH CHECK ADD  CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[AspNetUsers] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetUserLogins] CHECK CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId]
GO
ALTER TABLE [dbo].[AspNetUserRoles]  WITH CHECK ADD  CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY([RoleId])
REFERENCES [dbo].[AspNetRoles] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetUserRoles] CHECK CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId]
GO
ALTER TABLE [dbo].[AspNetUserRoles]  WITH CHECK ADD  CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[AspNetUsers] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetUserRoles] CHECK CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId]
GO
ALTER TABLE [dbo].[AspNetUserTokens]  WITH CHECK ADD  CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[AspNetUsers] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[AspNetUserTokens] CHECK CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId]
GO
/****** Object:  StoredProcedure [dbo].[Noticias_Add]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Noticias_Add]
@Titulo varchar(450),
@Fecha Datetime,
@TextoCorto varchar(450),
@Texto varchar(MAX),
@FotoUrl varchar(MAX),
@Autor varchar(100)
AS 
BEGIN 
     SET NOCOUNT ON 

     INSERT INTO dbo.Noticias
          ( 
            Titulo, Fecha, TextoCorto, Texto, FotoUrl, Autor 
          ) 
     VALUES 
          ( 
            @Titulo, @Fecha, @TextoCorto, @Texto, @FotoUrl, @Autor
          ) 

END 
GO
/****** Object:  StoredProcedure [dbo].[Noticias_Del]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Noticias_Del]
@Id int

AS 
BEGIN 
     SET NOCOUNT ON 

	 DELETE from Noticias where Id=@Id
	 


END 
GO
/****** Object:  StoredProcedure [dbo].[Noticias_Edit]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Noticias_Edit]
@Id int,
@Titulo varchar(450),
@Fecha Datetime,
@Texto varchar(MAX),
@TextoCorto varchar(MAX),
@FotoUrl varchar(MAX),
@Autor varchar(100)
AS 
BEGIN 
     SET NOCOUNT ON 

     UPDATE Noticias
     set Titulo=@Titulo, Fecha=@Fecha, TextoCorto=@TextoCorto, Texto=@Texto, FotoUrl=@FotoUrl, Autor=@Autor where Id = @Id

END 
GO
/****** Object:  StoredProcedure [dbo].[Noticias_GET]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Noticias_GET]
@Id int

AS 
BEGIN 
     SET NOCOUNT ON 

	 select Id, Titulo, Fecha, TextoCorto, Texto, FotoUrl, Autor from Noticias where Id = @Id


END 
GO
/****** Object:  StoredProcedure [dbo].[Noticias_List]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Noticias_List] 
	
AS
BEGIN
	
	SET NOCOUNT ON;

	Select Id, Titulo, TextoCorto, Texto, Fecha, FotoUrl, Autor from Noticias ORDER BY Id DESC
	
END


GO
/****** Object:  StoredProcedure [dbo].[Notificador_Get]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Notificador_Get]

AS 
BEGIN 
     SET NOCOUNT ON 

     Declare  @Noticias varchar(MAX)
     set @Noticias = (SELECT top 4 '"' + Titulo + '"' + ','  FROM Noticias ORDER BY Id DESC FOR XML PATH (''))
     select @Noticias     

END 
GO
/****** Object:  StoredProcedure [dbo].[Slider_Add]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
Create PROCEDURE [dbo].[Slider_Add]
@FotoUrl varchar(MAX),
@Clase varchar(50),
@Titulo varchar(MAX),
@Descripcion varchar(MAX),
@Id_Titular int,
@Fecha Datetime
AS 
BEGIN 
     SET NOCOUNT ON 

     INSERT INTO dbo.Slider
          ( 
            FotoUrl, Clase, Titulo, Descripcion, Id_Titular, Fecha 
          ) 
     VALUES 
          ( 
            @FotoUrl, @Clase, @Titulo, @Descripcion, @Id_Titular, @Fecha 
          ) 

END 
GO
/****** Object:  StoredProcedure [dbo].[Slider_Del]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Slider_Del]
@Id int

AS 
BEGIN 
     SET NOCOUNT ON 

	 DELETE from Slider where Id=@Id
	 --select FotoUrl, Clase, Titulo, Descripcion, Id_Titular, Fecha from Slider where Id = @Id


END 
GO
/****** Object:  StoredProcedure [dbo].[Slider_Edit]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Slider_Edit]
@Id int,
@FotoUrl varchar(MAX),
@Clase varchar(50),
@Titulo varchar(MAX),
@Descripcion varchar(MAX),
@Id_Titular int,
@Fecha Datetime
AS 
BEGIN 
     SET NOCOUNT ON 

     UPDATE Slider
     set FotoUrl = @FotoUrl, Clase = @Clase, Titulo = @Titulo, Descripcion = @Descripcion, Id_Titular = @Id_Titular, Fecha = @Fecha where Id = @Id

END 
GO
/****** Object:  StoredProcedure [dbo].[Slider_GET]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Slider_GET]
@Id int

AS 
BEGIN 
     SET NOCOUNT ON 

	 select FotoUrl, Clase, Titulo, Descripcion, Id_Titular, Fecha from Slider where Id = @Id


END 
GO
/****** Object:  StoredProcedure [dbo].[Slider_List]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Slider_List] 
	
AS
BEGIN
	
	SET NOCOUNT ON;

	Select Id, FotoUrl, Clase, Titulo, Descripcion, Id_Titular, Fecha, (Select Id from Slider where Clase Like '%active%') as Activo from Slider -- ORDER BY Id DESC
	
END


GO
/****** Object:  StoredProcedure [dbo].[Slider_Noticias_List]    Script Date: 10/12/2019 02:33:17 p. m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Mauricio Brindis>
-- Create date: <29-11-2019>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Slider_Noticias_List] 
	
AS
BEGIN
	
	SET NOCOUNT ON;

	Select Id as Id_Titulo, Titulo as Titulo_S from Noticias ORDER BY Id DESC
	--select Id as Id, Titulo as Titulo_S from Noticias n where not exists (select 1 from Slider s where n.Id = s.Id_Titular)
	
END

GO
